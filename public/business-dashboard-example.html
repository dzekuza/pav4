<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Analytics Dashboard - Pavlo4</title>
    
    <!-- Include the CSS -->
    <link rel="stylesheet" href="gadget-analytics.css">
    
    <style>
        /* Additional styles for this example page */
        body {
            margin: 0;
            padding: 0;
            background: #f5f5f5;
            font-family: Arial, sans-serif;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .api-key-warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #856404;
        }
        
        .api-key-warning strong {
            color: #856404;
        }
        
        .setup-instructions {
            background: #e8f4fd;
            padding: 20px;
            border-radius: 6px;
            margin-bottom: 30px;
        }
        
        .setup-instructions h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .setup-instructions ol {
            margin: 0;
            padding-left: 20px;
        }
        
        .setup-instructions li {
            margin-bottom: 10px;
            line-height: 1.6;
        }
        
        .code-block {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            margin: 10px 0;
        }
        
        .mock-data-notice {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ”¥ Pavlo4 Business Analytics</h1>
        <p>Complete dashboard showing checkout data from all your business partners</p>
    </div>
    
    <div class="container">
        <div class="api-key-warning">
            <strong>âš ï¸ Important:</strong> Before this dashboard will work, you need to:
            <ol>
                <li>Get the correct API key from your Gadget app settings</li>
                <li>Replace <code>gsk-X89z6jDWkTRqgq7htYnZi4wcXQ8L3B9g</code> in the <code>gadget-analytics.js</code> file with your actual API key</li>
            </ol>
        </div>
        
                <div class="mock-data-notice" style="background: #d4edda; border-color: #c3e6cb; color: #155724;">
          <strong>ğŸ‰ LIVE DATA:</strong> The dashboard is now connected to your real Gadget checkout system! This shows actual data from your business partners.
        </div>
        
        <div class="setup-instructions">
            <h3>ğŸ“‹ Setup Instructions</h3>
            <ol>
                <li><strong>Get API Key:</strong> Go to your Gadget app â†’ Settings â†’ API Keys â†’ Copy the key for "pavlo4-dashboard-access"</li>
                <li><strong>Update API Key:</strong> Open <code>gadget-analytics.js</code> and replace the API_KEY constant with your actual key</li>
                <li><strong>Test Connection:</strong> Refresh this page to see if the dashboard loads with real data</li>
                <li><strong>Deploy:</strong> Copy these files to your ipick.io and include them in your pages</li>
            </ol>
        </div>
        
        <!-- Dashboard Container -->
        <div id="business-dashboard"></div>
        
        <div class="setup-instructions">
            <h3>ğŸ”§ Integration Code</h3>
            <p>To add this dashboard to any page in your ipick.io, include these files:</p>
            
            <div class="code-block">
&lt;!-- Include the CSS and JavaScript files --&gt;
&lt;link rel="stylesheet" href="gadget-analytics.css"&gt;
&lt;script src="gadget-analytics.js"&gt;&lt;/script&gt;
&lt;script src="business-dashboard.js"&gt;&lt;/script&gt;

&lt;!-- Add the dashboard container --&gt;
&lt;div id="business-dashboard"&gt;&lt;/div&gt;

&lt;!-- Initialize the dashboard --&gt;
&lt;script&gt;
document.addEventListener('DOMContentLoaded', function() {
    const dashboard = new BusinessDashboard('business-dashboard');
    dashboard.render(); // Shows all businesses
    // Or render for specific business: dashboard.render('godislove.lt');
});
&lt;/script&gt;
            </div>
        </div>
        
        <div class="setup-instructions">
            <h3>ğŸ¯ Features</h3>
            <ul>
                <li><strong>ğŸ”¥ Pavlo4 Referral Highlighting:</strong> All referrals from your platform are highlighted with special styling</li>
                <li><strong>ğŸ“Š Real-time Analytics:</strong> Live data from all businesses using your tracking system</li>
                <li><strong>ğŸ’° Revenue Attribution:</strong> See exactly how much revenue each business generates from Pavlo4 referrals</li>
                <li><strong>ğŸ“ˆ Performance Trends:</strong> Compare 7-day vs 30-day performance</li>
                <li><strong>ğŸª Multi-Business Support:</strong> Switch between different business domains</li>
                <li><strong>ğŸ“± Responsive Design:</strong> Works perfectly on mobile and desktop</li>
            </ul>
        </div>
    </div>
    
    <!-- Include the JavaScript files -->
    <script src="gadget-analytics.js"></script>
    <script src="business-dashboard.js"></script>
    
    <script>
        // Mock data for demonstration
        const mockDashboardData = {
            success: true,
            data: {
                summary: {
                    totalBusinesses: 3,
                    businessDomain: 'All Businesses',
                    totalCheckouts: 47,
                    completedCheckouts: 28,
                    totalOrders: 28,
                    conversionRate: 59.57,
                    totalRevenue: 3247.50,
                    currency: 'EUR'
                },
                businesses: [
                    {
                        id: '1',
                        domain: 'godislove.lt',
                        myshopifyDomain: 'godislove.lt.myshopify.com',
                        name: 'God is Love Store',
                        email: 'info@godislove.lt',
                        currency: 'EUR',
                        plan: 'Basic',
                        createdAt: '2024-01-15T00:00:00Z'
                    },
                    {
                        id: '2',
                        domain: 'example.com',
                        myshopifyDomain: 'example.myshopify.com',
                        name: 'Example Store',
                        email: 'info@example.com',
                        currency: 'USD',
                        plan: 'Pro',
                        createdAt: '2024-02-01T00:00:00Z'
                    },
                    {
                        id: '3',
                        domain: 'testshop.com',
                        myshopifyDomain: 'testshop.myshopify.com',
                        name: 'Test Shop',
                        email: 'info@testshop.com',
                        currency: 'USD',
                        plan: 'Basic',
                        createdAt: '2024-03-01T00:00:00Z'
                    }
                ],
                recentCheckouts: [
                    {
                        id: '1',
                        email: 'customer1@godislove.lt',
                        totalPrice: '150.00',
                        currency: 'EUR',
                        createdAt: '2024-08-14T10:00:00Z',
                        completedAt: '2024-08-14T10:05:00Z',
                        sourceUrl: 'https://ipick.io/product/123',
                        sourceName: 'Pavlo4 Price Comparison',
                        name: '#1001',
                        token: 'token1',
                        processingStatus: 'complete',
                        isPavlo4Referral: true,
                        shop: { name: 'God is Love Store' }
                    },
                    {
                        id: '2',
                        email: 'customer2@example.com',
                        totalPrice: '75.50',
                        currency: 'USD',
                        createdAt: '2024-08-14T09:30:00Z',
                        completedAt: null,
                        sourceUrl: 'https://google.com',
                        sourceName: 'Google Search',
                        name: '#1002',
                        token: 'token2',
                        processingStatus: 'processing',
                        isPavlo4Referral: false,
                        shop: { name: 'Example Store' }
                    },
                    {
                        id: '3',
                        email: 'customer3@godislove.lt',
                        totalPrice: '200.00',
                        currency: 'EUR',
                        createdAt: '2024-08-14T08:00:00Z',
                        completedAt: '2024-08-14T08:10:00Z',
                        sourceUrl: 'https://ipick.io/product/456',
                        sourceName: 'Pavlo4 Price Comparison',
                        name: '#1003',
                        token: 'token3',
                        processingStatus: 'complete',
                        isPavlo4Referral: true,
                        shop: { name: 'God is Love Store' }
                    }
                ],
                recentOrders: [
                    {
                        id: '1',
                        name: '#1001',
                        email: 'customer1@godislove.lt',
                        totalPrice: '150.00',
                        currency: 'EUR',
                        financialStatus: 'paid',
                        fulfillmentStatus: 'fulfilled',
                        createdAt: '2024-08-14T10:05:00Z',
                        shop: { name: 'God is Love Store' }
                    },
                    {
                        id: '2',
                        name: '#1000',
                        email: 'customer3@example.com',
                        totalPrice: '200.00',
                        currency: 'USD',
                        financialStatus: 'pending',
                        fulfillmentStatus: 'unfulfilled',
                        createdAt: '2024-08-14T08:00:00Z',
                        shop: { name: 'Example Store' }
                    },
                    {
                        id: '3',
                        name: '#1003',
                        email: 'customer3@godislove.lt',
                        totalPrice: '200.00',
                        currency: 'EUR',
                        financialStatus: 'paid',
                        fulfillmentStatus: 'fulfilled',
                        createdAt: '2024-08-14T08:10:00Z',
                        shop: { name: 'God is Love Store' }
                    }
                ],
                referralStatistics: {
                    totalReferrals: 67,
                    pavlo4Referrals: 34,
                    pavlo4ConversionRate: 70.59,
                    totalConversions: 28,
                    referralRevenue: 1850.00,
                    topSources: {
                        'pavlo4': 34,
                        'google': 18,
                        'facebook': 8,
                        'direct': 7
                    }
                },
                trends: {
                    last30Days: {
                        checkouts: 47,
                        orders: 28,
                        revenue: 3247.50
                    },
                    last7Days: {
                        checkouts: 15,
                        orders: 9,
                        revenue: 950.00
                    }
                },
                orderStatuses: {
                    'paid': 22,
                    'pending': 6,
                    'refunded': 0
                },
                recentReferrals: [
                    {
                        id: '1',
                        referralId: 'ref1',
                        businessDomain: 'godislove.lt',
                        source: 'pavlo4',
                        medium: 'referral',
                        campaign: 'price-comparison',
                        conversionStatus: 'converted',
                        conversionValue: 150.00,
                        clickedAt: '2024-08-14T09:45:00Z',
                        isPavlo4: true,
                        shop: { name: 'God is Love Store' }
                    },
                    {
                        id: '2',
                        referralId: 'ref2',
                        businessDomain: 'example.com',
                        source: 'google',
                        medium: 'organic',
                        campaign: 'search',
                        conversionStatus: 'clicked',
                        conversionValue: 0,
                        clickedAt: '2024-08-14T09:30:00Z',
                        isPavlo4: false,
                        shop: { name: 'Example Store' }
                    }
                ]
            },
            metadata: {
                generatedAt: new Date().toISOString(),
                filters: {
                    businessDomain: null,
                    startDate: null,
                    endDate: null
                }
            }
        };

        // Override the analytics service to return mock data for demonstration
        class MockBusinessAnalytics {
            async generateDashboardData(businessDomain = null, startDate = null, endDate = null) {
                // Simulate API delay
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Return mock data
                return mockDashboardData;
            }
        }

        // Initialize the dashboard when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Use real analytics service (not mock data)
            const dashboard = new BusinessDashboard('business-dashboard');
            
            // Show all businesses by default
            dashboard.render();
            
            // You can also render for a specific business:
            // dashboard.render('godislove.lt');
        });
    </script>
</body>
</html>
