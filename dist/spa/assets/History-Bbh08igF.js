import{j as e,e as f,E as p}from"./vendor_ui-DPKP3YLX.js";import{r as t}from"./vendor_react-Bpl_dUPQ.js";import{S as n}from"./SearchHeader-BQRgaaLe.js";import{C as l,d as c}from"./card-C3AOPTFZ.js";import{B as i}from"./button-BVbCSO_a.js";import{B as S}from"./badge-CNTn68H-.js";import{A as k,a as C}from"./alert-CdpANgE4.js";import{a as A,L as j}from"./vendor_router-0FUT4RNd.js";import{b as D}from"./index-Bm7-4qCY.js";import{u as H,A as L}from"./AuthModal-DdX3VqK_.js";import"./index-DjoQLnK1.js";import"./index-BLqSjk83.js";import"./index-fqsw_NIb.js";import"./dialog-C3oruSML.js";import"./AuthForms-Bj6aRA0D.js";import"./input--XZmn13O.js";import"./label-09uxue2U.js";import"./tabs-DMdJGpTX.js";function Q(){const{isAuthenticated:o,isLoading:d}=D();A();const[m,g]=t.useState([]),[N,y]=t.useState(!0),[x,h]=t.useState(""),{modalProps:u}=H({title:"Sign in to view history",description:"Create an account or sign in to view your search history",defaultTab:"login"});t.useEffect(()=>{o&&w()},[o,d]);const w=async()=>{try{const s=await fetch("/api/search-history",{credentials:"include"});if(s.ok){const r=await s.json();g(r.history)}else h("Failed to fetch search history")}catch{h("Network error occurred")}finally{y(!1)}},b=s=>{const r=new Date(s),v=Math.abs(new Date().getTime()-r.getTime()),a=Math.ceil(v/(1e3*60*60*24));return a===1?"Today":a===2?"Yesterday":a<=7?`${a-1} days ago`:r.toLocaleDateString()};return d||N?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(n,{}),e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})})]}):o?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(n,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Search History"}),e.jsx("p",{className:"text-muted-foreground",children:"Your recent product price comparisons and searches"})]}),x&&e.jsx(k,{variant:"destructive",className:"mb-6",children:e.jsx(C,{children:x})}),m.length===0?e.jsx(l,{className:"border-2 border-dashed border-muted-foreground/25",children:e.jsxs(c,{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:"🔍"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No search history yet"}),e.jsx("p",{className:"text-muted-foreground mb-6",children:"Your recent product searches will appear here. Start by searching for any product URL to build your history."}),e.jsx(i,{asChild:!0,children:e.jsx(j,{to:"/",children:"Start Searching"})})]})}):e.jsx("div",{className:"space-y-4",children:m.map((s,r)=>e.jsx(l,{className:"hover:shadow-md transition-shadow",children:e.jsx(c,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 md:gap-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-muted-foreground mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(f,{className:"h-4 w-4"}),b(s.timestamp)]}),e.jsxs(S,{variant:"outline",children:["ID: ",s.requestId.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground break-all max-w-full",children:[e.jsx(p,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-full md:max-w-md",children:s.url})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[e.jsx(i,{asChild:!0,size:"sm",className:"w-full md:w-auto",children:e.jsx(j,{to:`/new-search/${s.requestId}/results`,children:"View Results"})}),e.jsx(i,{variant:"outline",size:"sm",asChild:!0,className:"w-full md:w-auto",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(p,{className:"mr-2 h-3 w-3"}),"Original"]})})]})]})})},r))})]})})]}):e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(n,{}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsx(l,{className:"max-w-md mx-auto",children:e.jsxs(c,{className:"p-8 text-center",children:[e.jsx(f,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sign in to view history"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Create an account or sign in to view your search history."}),e.jsx(i,{onClick:()=>u.onClose(),children:"Sign In"})]})}),e.jsx(L,{...u})]})]})}export{Q as default};
