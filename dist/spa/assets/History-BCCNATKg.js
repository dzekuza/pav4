import{j as e,e as w,E as b}from"./vendor_ui-DPKP3YLX.js";import{r as a}from"./vendor_react-Bpl_dUPQ.js";import{S as o}from"./SearchHeader-BXp9_NKE.js";import{C as c,d as n}from"./card-CUmbL-D9.js";import{B as i}from"./button-DP2dp-PV.js";import{B as k}from"./badge-Cx_qSRgY.js";import{A as S,a as C}from"./alert-DD_X1c11.js";import{a as A,L as f}from"./vendor_router-0FUT4RNd.js";import{b as D}from"./index-ZVa9_c7w.js";import{u as H,A as L}from"./AuthModal-CzmKQ8qE.js";import"./index-BrMgMA-w.js";import"./index-DxE6KrYo.js";import"./index-B6HsZdxu.js";import"./dialog-CLJAIzey.js";import"./AuthForms-Cj0L76cW.js";import"./input-Bt03Fmew.js";import"./label-Ci8XuWqp.js";import"./tabs-eeJMkpL9.js";function Q(){const{isAuthenticated:l,isLoading:d}=D();A();const[h,p]=a.useState([]),[j,g]=a.useState(!0),[m,x]=a.useState(""),{modalProps:u}=H({title:"Sign in to view history",description:"Create an account or sign in to view your search history",defaultTab:"login"});a.useEffect(()=>{l&&N()},[l,d]);const N=async()=>{try{const s=await fetch("/api/search-history",{credentials:"include"});if(s.ok){const t=await s.json();p(t.history)}else x("Failed to fetch search history")}catch{x("Network error occurred")}finally{g(!1)}},v=s=>{const t=new Date(s),y=Math.abs(new Date().getTime()-t.getTime()),r=Math.ceil(y/(1e3*60*60*24));return r===1?"Today":r===2?"Yesterday":r<=7?`${r-1} days ago`:t.toLocaleDateString()};return d||j?e.jsxs("div",{className:"relative min-h-screen overflow-hidden text-white",children:[e.jsx("img",{src:"/pagebg.png",alt:"",className:"pointer-events-none absolute inset-0 -z-10 h-full w-full object-cover opacity-100"}),e.jsx(o,{}),e.jsx("div",{className:"container mx-auto px-4 py-16",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})})})]}):l?e.jsxs("div",{className:"relative min-h-screen overflow-hidden text-white",children:[e.jsx("img",{src:"/pagebg.png",alt:"",className:"pointer-events-none absolute inset-0 -z-10 h-full w-full object-cover opacity-100"}),e.jsx(o,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Search History"}),e.jsx("p",{className:"text-white/70",children:"Your recent product price comparisons and searches"})]}),m&&e.jsx(S,{variant:"destructive",className:"mb-6",children:e.jsx(C,{children:m})}),h.length===0?e.jsx(c,{className:"border-white/10 bg-white/5 text-white backdrop-blur-sm",children:e.jsxs(n,{className:"p-12 text-center",children:[e.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full border border-white/20 bg-white/10 flex items-center justify-center",children:"🔍"}),e.jsx("h2",{className:"text-xl font-semibold mb-2",children:"No search history yet"}),e.jsx("p",{className:"text-white/70 mb-6",children:"Your recent product searches will appear here. Start by searching for any product URL to build your history."}),e.jsx(i,{asChild:!0,className:"rounded-full bg-white text-black border border-black/10 hover:bg-white/90",children:e.jsx(f,{to:"/",children:"Start Searching"})})]})}):e.jsx("div",{className:"space-y-4",children:h.map((s,t)=>e.jsx(c,{className:"hover:shadow-md transition-shadow border-white/10 bg-white/5 text-white backdrop-blur-sm",children:e.jsx(n,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-4 md:gap-0",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2 line-clamp-2 text-white",children:s.title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 text-sm text-white/70 mb-3",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"h-4 w-4"}),v(s.timestamp)]}),e.jsxs(k,{variant:"outline",className:"text-white border-white/30",children:["ID: ",s.requestId.slice(0,8),"..."]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-white/70 break-all max-w-full",children:[e.jsx(b,{className:"h-4 w-4 flex-shrink-0"}),e.jsx("span",{className:"truncate max-w-full md:max-w-md",children:s.url})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[e.jsx(i,{asChild:!0,size:"sm",className:"w-full md:w-auto rounded-full bg-white text-black border border-black/10 hover:bg-white/90",children:e.jsx(f,{to:`/new-search/${s.requestId}/results`,children:"View Results"})}),e.jsx(i,{variant:"outline",size:"sm",asChild:!0,className:"w-full md:w-auto rounded-full bg-white text-black border border-black/10 hover:bg-white/90",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(b,{className:"mr-2 h-3 w-3"}),"Original"]})})]})]})})},t))})]})})]}):e.jsxs("div",{className:"relative min-h-screen overflow-hidden text-white",children:[e.jsx("img",{src:"/pagebg.png",alt:"",className:"pointer-events-none absolute inset-0 -z-10 h-full w-full object-cover opacity-100"}),e.jsx(o,{}),e.jsxs("div",{className:"container mx-auto px-4 py-16",children:[e.jsx(c,{className:"max-w-md mx-auto border-white/10 bg-white/5 text-white backdrop-blur-sm",children:e.jsxs(n,{className:"p-8 text-center",children:[e.jsx(w,{className:"h-12 w-12 text-white/60 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"Sign in to view history"}),e.jsx("p",{className:"text-white/70 mb-4",children:"Create an account or sign in to view your search history."}),e.jsx(i,{onClick:()=>u.onClose(),className:"rounded-full bg-white text-black border border-black/10 hover:bg-white/90",children:"Sign In"})]})}),e.jsx(L,{...u})]})]})}export{Q as default};
